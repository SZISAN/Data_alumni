fetch("https://spreadsheets.google.com/feeds/list/1fkd8E9TIgTWhXrddQJiloSafe9GThcpt9s9v2-6obbI/od6/public/values?alt=json")
  .then(response => response.json())
  .then(data => {
    const alumniData = data.feed.entry;
    displayAlumni(alumniData);
  })
  .catch(error => console.error("Error fetching data: ", error));

function displayAlumni(data) {
  const alumniList = document.getElementById("alumni-list");
  alumniList.innerHTML = "";

  data.forEach(alumnus => {
    const profile = document.createElement("div");
    profile.classList.add("alumni-profile");

    const name = alumnus.gsx$name.$t;
    const department = alumnus.gsx$department.$t;
    const graduationYear = alumnus.gsx$graduationyear.$t;
    const email = alumnus.gsx$email.$t;
    const linkedin = alumnus.gsx$linkedin.$t;

    profile.innerHTML = `
      <h3>${name}</h3>
      <p>Department: ${department}</p>
      <p>Graduation Year: ${graduationYear}</p>
      <p>Email: <a href="mailto:${email}">${email}</a></p>
      <p><a href="${linkedin}" target="_blank">LinkedIn</a></p>
    `;

    alumniList.appendChild(profile);
  });
}
